@page "/progress"
@inject IJSRuntime JSRuntime

<!-- Main container spacing -->
<div class="space-y-8 p-4">
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center border-b pb-3 border-gray-200">
        <!-- Page title and subtitle -->
        <h1 class="text-4xl font-extrabold text-gray-800">
            Progress & Deep Dive Analysis
        </h1>
        <p class="text-sm text-gray-500 mt-1 sm:mt-0">Visualize your achievements and trends.</p>
    </div>

    <!-- Filter section for activity and date range -->
    <div class="bg-white p-5 rounded-3xl shadow-lg flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0 md:space-x-4 border border-gray-100">

        <!-- Activity filter dropdown -->
        <div class="flex items-center space-x-3 w-full md:w-auto">
            <label for="activity-filter" class="text-sm font-medium text-gray-700 whitespace-nowrap">Activity:</label>
            <select id="activity-filter" class="w-full md:w-40 p-3 border border-gray-300 rounded-xl focus:ring-cyan-500 focus:border-cyan-500 transition duration-150 ease-in-out text-sm shadow-sm">
                <option>All Workouts</option>
                <option>Running (Distance)</option>
                <option>Lifting (Weight)</option>
                <option>Steps (Count)</option>
            </select>
        </div>

        <!-- Date range dropdown -->
        <div class="flex items-center space-x-3 w-full md:w-auto">
            <label for="date-range" class="text-sm font-medium text-gray-700 whitespace-nowrap">Range:</label>
            <select id="date-range" class="w-full md:w-40 p-3 border border-gray-300 rounded-xl focus:ring-lime-500 focus:border-lime-500 transition duration-150 ease-in-out text-sm shadow-sm">
                <option>Last 30 Days</option>
                <option>Last 7 Days</option>
                <option>This Month</option>
                <option>Yearly</option>
            </select>
        </div>

        <!-- Apply filter button -->
        <button class="w-full md:w-auto px-6 py-3 bg-cyan-600 text-white font-semibold rounded-xl shadow-lg hover:bg-cyan-700 focus:outline-none focus:ring-4 focus:ring-cyan-300 transition duration-150 ease-in-out text-sm">
            Apply Filters
        </button>
    </div>

    <!-- Main chart display area -->
    <div class="bg-white p-6 rounded-3xl shadow-2xl border border-cyan-100/50">
        <h2 class="text-xl font-bold text-gray-800 mb-4">Trend: Running Performance (Last 5 Weeks)</h2>
        <div class="h-80 w-full">
            <!-- Chart.js Canvas -->
            <canvas id="progressChart"></canvas>
        </div>
    </div>

    <!-- Summary metric cards section -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">

        <!-- Peak performance metric card -->
        <div class="bg-white p-6 rounded-2xl shadow-xl border-l-8 border-cyan-500 hover:shadow-2xl transition duration-300">
            <p class="text-sm font-medium text-gray-500">Peak Distance</p>
            <p class="text-4xl font-extrabold text-cyan-700 mt-1">12.5 <span class="text-lg font-semibold text-gray-600">km</span></p>
            <p class="text-xs text-gray-400 mt-1">Your longest recorded run.</p>
        </div>

        <!-- Weekly average metric card -->
        <div class="bg-white p-6 rounded-2xl shadow-xl border-l-8 border-lime-500 hover:shadow-2xl transition duration-300">
            <p class="text-sm font-medium text-gray-500">Weekly Average</p>
            <p class="text-4xl font-extrabold text-lime-700 mt-1">4.2 <span class="text-lg font-semibold text-gray-600">workouts</span></p>
            <p class="text-xs text-gray-400 mt-1">Consistent activity level maintained.</p>
        </div>

        <!-- Total calories metric card -->
        <div class="bg-white p-6 rounded-2xl shadow-xl border-l-8 border-gray-300 hover:shadow-2xl transition duration-300">
            <p class="text-sm font-medium text-gray-500">Total Calories (All Time)</p>
            <p class="text-4xl font-extrabold text-gray-700 mt-1">15,890 <span class="text-lg font-semibold text-gray-600">kcal</span></p>
            <p class="text-xs text-gray-400 mt-1">A significant lifetime achievement!</p>
        </div>
    </div>
</div>

@* @code {
    private bool firstRender = true;

    // Executes after component rendering
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        // Ensures chart loads only once
        if (firstRender)
        {
            await JSRuntime.InvokeVoidAsync("renderProgressChart");
            firstRender = false;
        }
    }
} *@

<!-- JavaScript: Chart.js configuration and dummy dataset -->
@* <script>
    window.renderProgressChart = () => {
        const ctx = document.getElementById('progressChart');

        // Primary chart color (cyan)
        const primaryColor = 'rgba(6, 182, 212, 1)'; // Tailwind cyan-600

        if (ctx) {
            new Chart(ctx, {
                type: 'line', // Line chart
                data: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5'], // X-axis labels
                    datasets: [{
                        label: 'Distance (km)',
                        data: [15, 18, 16, 22, 25], // Dummy values
                        backgroundColor: 'rgba(6, 182, 212, 0.4)', // Light cyan fill
                        borderColor: primaryColor, // Line color
                        borderWidth: 4, // Line thickness
                        pointBackgroundColor: primaryColor, // Data point color
                        pointBorderColor: '#fff',
                        pointHoverRadius: 6, // Point hover size
                        tension: 0.4, // Smooth curve
                        fill: 'start', // Fill under curve
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Kilometers' // Y-axis label
                            },
                            grid: {
                                color: 'rgba(200, 200, 200, 0.2)' // Light grid
                            }
                        },
                        x: {
                            grid: {
                                display: false // Hide X grid
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false // Hide chart legend
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0,0,0,0.8)', // Tooltip background
                            padding: 10,
                            titleFont: { size: 14 },
                            bodyFont: { size: 14 }
                        }
                    }
                }
            });
        }
    };
</script> *@